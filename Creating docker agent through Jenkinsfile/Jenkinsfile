pipeline {
    agent {
        docker { image 'httpd:latest' }
    }
    
    stages {
        stage('Run Apache Server') {
            steps {
                script {
                    // Run Docker container with Apache server
                    sh '''
                       sudo docker run -d -p 80:81 --name my-apache-container httpd:latest
                    '''
                }
            }
        }
    }
    
    post {
        always {
            // Clean up: Stop and remove the Docker container
            script {
                sh '''
                    sudo docker stop my-apache-container
                '''
            }
        }
    }
}
